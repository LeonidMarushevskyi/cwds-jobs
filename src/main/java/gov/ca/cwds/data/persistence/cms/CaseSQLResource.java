package gov.ca.cwds.data.persistence.cms;

import gov.ca.cwds.data.std.ApiMarker;

public class CaseSQLResource implements ApiMarker {

  private static final long serialVersionUID = 1L;

  //@formatter:off
  public static final String INSERT_CLIENT_FULL =
      "\nINSERT INTO GT_ID (IDENTIFIER) \n"
          +" SELECT c.IDENTIFIER \n"
          +" FROM CLIENT_T C \n"
          +" WHERE c.IDENTIFIER BETWEEN ? AND ? \n"
          +" AND c.IBMSNAP_OPERATION IN ('I','U') \n"
          +" AND ( \n"
          +"  EXISTS ( \n"
          +"     SELECT CAS1.FKCHLD_CLT \n"
          +"     FROM CASE_T CAS1  \n"
          +"     WHERE CAS1.FKCHLD_CLT = c.IDENTIFIER \n"
          +"  )\n"
          +"  OR EXISTS (\n"
          +"      SELECT REL2.FKCLIENT_T \n"
          +"      FROM CLN_RELT REL2 \n"
          +"      JOIN CASE_T   CAS2 ON CAS2.FKCHLD_CLT = REL2.FKCLIENT_0 \n"
          +"      WHERE REL2.FKCLIENT_T = c.IDENTIFIER \n"
          +"  ) \n"
          +"  OR EXISTS ( \n"
          +"      SELECT REL3.FKCLIENT_0 \n"
          +"      FROM CLN_RELT REL3 \n"
          +"      JOIN CASE_T   CAS3 ON CAS3.FKCHLD_CLT = REL3.FKCLIENT_T \n"
          +"      WHERE REL3.FKCLIENT_0 = c.IDENTIFIER \n"
          +"  ) \n"
          +") \n";
  //@formatter:on

  //@formatter:off
  public static final String INSERT_CLIENT_CASE_FULL =
      "INSERT INTO GT_REFR_CLT (FKREFERL_T, FKCLIENT_T, SENSTV_IND)"
     + " SELECT \n"
          + " CAS1.IDENTIFIER      AS CASE_ID, \n"
          + " CAS1.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV1.THIS_CLIENT_ID  AS THIS_CLIENT_ID, \n"
          + " SUBSTR ('F', 1, 1)   AS FOCUS_IND, \n"
          + " 0                    AS REL_FOCUS_TO_OTHER,  \n"
          + " 0                    AS REL_OTHER_TO_FOCUS  \n"
          + "FROM GT_ID DRV1 \n"
          + "JOIN CASE_T CAS1 ON CAS1.FKCHLD_CLT = DRV1.IDENTIFIER \n"
          + "WHERE CAS1.IBMSNAP_OPERATION IN ('I','U') \n"
     + "UNION ALL \n"
          + "SELECT   \n"
          + " CAS2.IDENTIFIER      AS CASE_ID, \n"
          + " CAS2.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV2.THIS_CLIENT_ID  AS THIS_CLIENT_ID, \n"
          + " SUBSTR (' ', 1, 1)   AS FOCUS_IND,  \n"
          + " REL2.CLNTRELC        AS REL_FOCUS_TO_OTHER, \n"
          + " 0                    AS REL_OTHER_TO_FOCUS \n"
          + "FROM GT_ID DRV2 \n"
          + "JOIN CLN_RELT REL2 ON REL2.FKCLIENT_T = DRV2.IDENTIFIER \n"
          + "JOIN CASE_T   CAS2 ON CAS2.FKCHLD_CLT = REL2.FKCLIENT_0 \n"
          + "WHERE CAS2.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL2.IBMSNAP_OPERATION IN ('I','U') \n"
    + "UNION ALL \n"
          + "SELECT  \n"
          + " CAS3.IDENTIFIER      AS CASE_ID, \n"
          + " CAS3.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV3.THIS_CLIENT_ID  AS THIS_CLIENT_ID, \n"
          + " SUBSTR (' ', 1, 1)   AS FOCUS_IND, \n"
          + " 0                    AS REL_FOCUS_TO_OTHER, \n"
          + " REL3.CLNTRELC        AS REL_OTHER_TO_FOCUS \n"
          + "FROM GT_ID DRV3, CLN_RELT REL3, CASE_T CAS3 \n"
          + "WHERE CAS3.FKCHLD_CLT = REL3.FKCLIENT_T \n"
          + "AND REL3.FKCLIENT_0 = DRV3.IDENTIFIER \n"
          + "  AND CAS3.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL3.IBMSNAP_OPERATION IN ('I','U') \n"
          ;
  //@formatter:on

  //@formatter:off
  public static final String SELECT_CLIENT_CASE =
        "SELECT rc.FKCLIENT_T, rc.FKREFERL_T, rc.SENSTV_IND\n" 
      + "FROM GT_REFR_CLT RC \n";
  //@formatter:on

  //@formatter:off
  public static final String SELECT_CASE_DETAIL =
        "WITH driver AS ( \n"
          + " SELECT gt.IDENTIFIER AS THIS_CLIENT_ID \n"
          + " FROM GT_ID gt  \n"
          + ") \n"
          + "SELECT DISTINCT \n"
          + " CAS1.IDENTIFIER    AS CASE_ID,  \n"
          + " CAS1.FKCHLD_CLT    AS FOCUS_CHILD_ID,  \n"
          + " CAS1.CASE_NM       AS CASE_NAME,  \n"
          + " CAS1.START_DT      AS START_DATE,  \n"
          + " CAS1.END_DT        AS END_DATE, \n"
          + " CAS1.SRV_CMPC      AS SERVICE_COMP,  \n"
          + " CAS1.CLS_RSNC      AS CLOSE_REASON_CODE,  \n"
          + " CAS1.FKSTFPERST    AS WORKER_ID,  \n"
          + " CAS1.LMT_ACSSCD    AS LIMITED_ACCESS_CODE, \n"
          + " CAS1.LMT_ACS_DT    AS LIMITED_ACCESS_DATE, \n"
          + " CAS1.LMT_ACSDSC    AS LIMITED_ACCESS_DESCRIPTION, \n"
          + " CAS1.L_GVR_ENTC    AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
          + " CAS1.LST_UPD_TS    AS CASE_LAST_UPDATED, \n"
          + " CAS1.GVR_ENTC      AS COUNTY,  \n"
          + " CAS1.APV_STC \n"
          + "FROM driver D1 \n"
          + "JOIN CASE_T CAS1 ON CAS1.FKCHLD_CLT = d1.THIS_CLIENT_ID \n"
          + "WHERE CAS1.IBMSNAP_OPERATION IN ('I','U') \n"
          + "UNION \n"
          + "SELECT DISTINCT \n"
          + " CAS2.IDENTIFIER    AS CASE_ID, \n"
          + " CAS2.FKCHLD_CLT    AS FOCUS_CHILD_ID, \n"
          + " CAS2.CASE_NM       AS CASE_NAME, \n"
          + " CAS2.START_DT      AS START_DATE, \n"
          + " CAS2.END_DT        AS END_DATE, \n"
          + " CAS2.SRV_CMPC      AS SERVICE_COMP, \n"
          + " CAS2.CLS_RSNC      AS CLOSE_REASON_CODE, \n"
          + " CAS2.FKSTFPERST    AS WORKER_ID, \n"
          + " CAS2.LMT_ACSSCD    AS LIMITED_ACCESS_CODE, \n"
          + " CAS2.LMT_ACS_DT    AS LIMITED_ACCESS_DATE, \n"
          + " CAS2.LMT_ACSDSC    AS LIMITED_ACCESS_DESCRIPTION, \n"
          + " CAS2.L_GVR_ENTC    AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
          + " CAS2.LST_UPD_TS    AS CASE_LAST_UPDATED, \n"
          + " CAS2.GVR_ENTC      AS COUNTY,  \n"
          + " CAS2.APV_STC \n"
          + "FROM driver d2 \n"
          + "JOIN CLN_RELT REL2 ON REL2.FKCLIENT_T = d2.THIS_CLIENT_ID \n"
          + "JOIN CASE_T   CAS2 ON CAS2.FKCHLD_CLT = REL2.FKCLIENT_0 \n"
          + "WHERE CAS2.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL2.IBMSNAP_OPERATION IN ('I','U') \n"
          + "UNION \n"
          + "SELECT DISTINCT \n"
          + " CAS3.IDENTIFIER    AS CASE_ID, \n"
          + " CAS3.FKCHLD_CLT    AS FOCUS_CHILD_ID, \n"
          + " CAS3.CASE_NM       AS CASE_NAME, \n"
          + " CAS3.START_DT      AS START_DATE, \n"
          + " CAS3.END_DT        AS END_DATE, \n"
          + " CAS3.SRV_CMPC      AS SERVICE_COMP, \n"
          + " CAS3.CLS_RSNC      AS CLOSE_REASON_CODE, \n"
          + " CAS3.FKSTFPERST    AS WORKER_ID, \n"
          + " CAS3.LMT_ACSSCD    AS LIMITED_ACCESS_CODE, \n"
          + " CAS3.LMT_ACS_DT    AS LIMITED_ACCESS_DATE, \n"
          + " CAS3.LMT_ACSDSC    AS LIMITED_ACCESS_DESCRIPTION, \n"
          + " CAS3.L_GVR_ENTC    AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
          + " CAS3.LST_UPD_TS    AS CASE_LAST_UPDATED, \n"
          + " CAS3.GVR_ENTC      AS COUNTY,  \n"
          + " CAS3.APV_STC \n"
          + "FROM driver d3, CLN_RELT REL3, CASE_T CAS3 \n"
          + "WHERE CAS3.FKCHLD_CLT = REL3.FKCLIENT_T AND REL3.FKCLIENT_0 = d3.THIS_CLIENT_ID \n"
          + "  AND CAS3.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL3.IBMSNAP_OPERATION IN ('I','U') \n"
          + "WITH UR  \n";
  //@formatter:on

  //@formatter:off
  public static final String SELECT_CLIENT_FULL = 
      "\nSELECT \n"
          + "    c.IDENTIFIER        AS CLIENT_ID \n"
          + "  , c.COM_FST_NM        AS CLIENT_FIRST_NM \n"
          + "  , c.COM_LST_NM        AS CLIENT_LAST_NM \n"
          + "  , c.SENSTV_IND        AS CLIENT_SENSITIVITY_IND \n"
          + "  , c.LST_UPD_TS        AS CLIENT_LAST_UPDATED \n"
          + "  , c.IBMSNAP_LOGMARKER AS CLIENT_LOGMARKER \n"
          + "  , c.IBMSNAP_OPERATION AS CLIENT_OPERATION \n"
          + " FROM GT_ID GT \n"
          + " JOIN CLIENT_T C ON C.IDENTIFIER = GT.IDENTIFIER \n"
      + " FOR READ ONLY WITH UR ";
  //@formatter:on

  //@formatter:off
  public static final String SELECT_CLIENT_CASE_RELATIONSHIP = 
       " SELECT \n"
          + " CAS1.IDENTIFIER      AS CASE_ID, \n"
          + " CAS1.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV1.IDENTIFIER      AS THIS_CLIENT_ID, \n"
          + " 1                    AS STANZA, \n"
          + " 0                    AS RELATION \n"
          + "FROM GT_ID DRV1 \n"
          + "JOIN CASE_T CAS1 ON CAS1.FKCHLD_CLT = DRV1.IDENTIFIER \n"
          + "WHERE CAS1.IBMSNAP_OPERATION IN ('I','U') \n"
     + "UNION ALL \n"
          + "SELECT   \n"
          + " CAS2.IDENTIFIER      AS CASE_ID, \n"
          + " CAS2.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV2.IDENTIFIER      AS THIS_CLIENT_ID, \n"
          + " 2                    AS STANZA, \n"
          + " REL2.CLNTRELC        AS RELATION \n"
          + "FROM GT_ID DRV2 \n"
          + "JOIN CLN_RELT REL2 ON REL2.FKCLIENT_T = DRV2.IDENTIFIER \n"
          + "JOIN CASE_T   CAS2 ON CAS2.FKCHLD_CLT = REL2.FKCLIENT_0 \n"
          + "WHERE CAS2.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL2.IBMSNAP_OPERATION IN ('I','U') \n"
    + "UNION ALL \n"
          + "SELECT  \n"
          + " CAS3.IDENTIFIER      AS CASE_ID, \n"
          + " CAS3.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV3.IDENTIFIER      AS THIS_CLIENT_ID, \n"
          + " 3                    AS STANZA, \n"
          + " REL3.CLNTRELC        AS RELATION \n"
          + "FROM GT_ID DRV3, CLN_RELT REL3, CASE_T CAS3 \n"
          + "WHERE CAS3.FKCHLD_CLT = REL3.FKCLIENT_T \n"
          + "AND REL3.FKCLIENT_0 = DRV3.IDENTIFIER \n"
          + "  AND CAS3.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL3.IBMSNAP_OPERATION IN ('I','U') \n"
     + " FOR READ ONLY WITH UR ";
  //@formatter:on

  /**
   * Original, overkill approach. Brings back too much redundant data.
   */
  //@formatter:off
  public static final String SELECT_CASES_FULL_EVERYTHING = 
      "\nWITH DRIVER AS (\n"
          + " SELECT \n"
          + "       c.IDENTIFIER        AS THIS_CLIENT_ID \n"
          + "     , c.COM_FST_NM        AS THIS_CLIENT_FIRST_NM \n"
          + "     , c.COM_LST_NM        AS THIS_CLIENT_LAST_NM \n"
          + "     , c.SENSTV_IND        AS THIS_CLIENT_SENSITIVITY_IND \n"
          + "     , c.LST_UPD_TS        AS THIS_CLIENT_LAST_UPDATED \n"
          + "     , c.IBMSNAP_LOGMARKER AS THIS_CLIENT_LOGMARKER \n"
          + "     , c.IBMSNAP_OPERATION AS THIS_CLIENT_OPERATION \n"
          + " FROM GT_ID GT \n"
          + " JOIN CLIENT_T C ON C.IDENTIFIER = GT.IDENTIFIER \n"
          + ") \n"
     + " SELECT \n"
          + " CAS1.IDENTIFIER      AS CASE_ID, \n"
          + " CAS1.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV1.THIS_CLIENT_ID  AS THIS_CLIENT_ID, \n"
          + " 1                    AS STANZA, \n"
          + " 0                    AS REL_FOCUS_TO_OTHER, \n"
          + " 0                    AS REL_OTHER_TO_FOCUS, \n"
          + " CAS1.CASE_NM         AS CASE_NAME, \n"
          + " CAS1.START_DT        AS START_DATE, \n"
          + " CAS1.END_DT          AS END_DATE, \n"
          + " CAS1.SRV_CMPC        AS SERVICE_COMP, \n"
          + " CAS1.CLS_RSNC        AS CLOSE_REASON_CODE, \n"
          + " CAS1.FKSTFPERST      AS WORKER_ID, \n"
          + " CAS1.LMT_ACSSCD      AS LIMITED_ACCESS_CODE, \n"
          + " CAS1.LMT_ACS_DT      AS LIMITED_ACCESS_DATE, \n"
          + " CAS1.LMT_ACSDSC      AS LIMITED_ACCESS_DESCRIPTION, \n"
          + " CAS1.L_GVR_ENTC      AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
          + " CAS1.LST_UPD_TS      AS CASE_LAST_UPDATED, \n"
          + " CAS1.GVR_ENTC        AS COUNTY, \n"
          + " CAS1.APV_STC \n"
          + "FROM DRIVER DRV1 \n"
          + "JOIN CASE_T CAS1 ON CAS1.FKCHLD_CLT = DRV1.THIS_CLIENT_ID \n"
          + "WHERE CAS1.IBMSNAP_OPERATION IN ('I','U') \n"
     + "UNION ALL \n"
          + "SELECT  \n"
          + " CAS2.IDENTIFIER      AS CASE_ID, \n"
          + " CAS2.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV2.THIS_CLIENT_ID  AS THIS_CLIENT_ID, \n"
          + " 2                    AS STANZA, \n"
          + " REL2.CLNTRELC        AS REL_FOCUS_TO_OTHER, \n"
          + " 0                    AS REL_OTHER_TO_FOCUS, \n"
          + " CAS2.CASE_NM         AS CASE_NAME, \n"
          + " CAS2.START_DT        AS START_DATE, \n"
          + " CAS2.END_DT          AS END_DATE, \n"
          + " CAS2.SRV_CMPC        AS SERVICE_COMP, \n"
          + " CAS2.CLS_RSNC        AS CLOSE_REASON_CODE, \n"
          + " CAS2.FKSTFPERST      AS WORKER_ID, \n"
          + " CAS2.LMT_ACSSCD      AS LIMITED_ACCESS_CODE, \n"
          + " CAS2.LMT_ACS_DT      AS LIMITED_ACCESS_DATE, \n"
          + " CAS2.LMT_ACSDSC      AS LIMITED_ACCESS_DESCRIPTION, \n"
          + " CAS2.L_GVR_ENTC      AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
          + " CAS2.LST_UPD_TS      AS CASE_LAST_UPDATED, \n"
          + " CAS2.GVR_ENTC        AS COUNTY, \n"
          + " CAS2.APV_STC \n"
          + "FROM DRIVER DRV2 \n"
          + "JOIN CLN_RELT REL2 ON REL2.FKCLIENT_T = DRV2.THIS_CLIENT_ID \n"
          + "JOIN CASE_T   CAS2 ON CAS2.FKCHLD_CLT = REL2.FKCLIENT_0 \n"
          + "WHERE CAS2.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL2.IBMSNAP_OPERATION IN ('I','U') \n"
    + "UNION ALL \n"
          + "SELECT  \n"
          + " CAS3.IDENTIFIER      AS CASE_ID, \n"
          + " CAS3.FKCHLD_CLT      AS FOCUS_CHILD_ID, \n"
          + " DRV3.THIS_CLIENT_ID  AS THIS_CLIENT_ID, \n"
          + " 3                    AS STANZA, \n"
          + " 0                    AS REL_FOCUS_TO_OTHER, \n"
          + " REL3.CLNTRELC        AS REL_OTHER_TO_FOCUS, \n"
          + " CAS3.CASE_NM         AS CASE_NAME, \n"
          + " CAS3.START_DT        AS START_DATE, \n"
          + " CAS3.END_DT          AS END_DATE, \n"
          + " CAS3.SRV_CMPC        AS SERVICE_COMP, \n"
          + " CAS3.CLS_RSNC        AS CLOSE_REASON_CODE, \n"
          + " CAS3.FKSTFPERST      AS WORKER_ID, \n"
          + " CAS3.LMT_ACSSCD      AS LIMITED_ACCESS_CODE, \n"
          + " CAS3.LMT_ACS_DT      AS LIMITED_ACCESS_DATE, \n"
          + " CAS3.LMT_ACSDSC      AS LIMITED_ACCESS_DESCRIPTION, \n"
          + " CAS3.L_GVR_ENTC      AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
          + " CAS3.LST_UPD_TS      AS CASE_LAST_UPDATED, \n"
          + " CAS3.GVR_ENTC        AS COUNTY, \n"
          + " CAS3.APV_STC \n"
          + "FROM DRIVER DRV3, CLN_RELT REL3, CASE_T CAS3 \n"
          + "WHERE CAS3.FKCHLD_CLT = REL3.FKCLIENT_T AND REL3.FKCLIENT_0 = DRV3.THIS_CLIENT_ID \n"
          + "  AND CAS3.IBMSNAP_OPERATION IN ('I','U') \n"
          + "  AND REL3.IBMSNAP_OPERATION IN ('I','U') \n"
     + " FOR READ ONLY WITH UR ";
  //@formatter:on

  /**
   * Filter <strong>deleted</strong> Clients and Cases.
   */
  //@formatter:off
  public static final String INSERT_CLIENT_LAST_CHG =  
      "INSERT INTO GT_ID (IDENTIFIER)"
      + "\nSELECT DISTINCT X.IDENTIFIER FROM ( "
          + "\nSELECT CAS1.IDENTIFIER"
           + "\n FROM CASE_T CAS1 "
           + "\nWHERE CAS1.IBMSNAP_LOGMARKER > ? "
       + "\nUNION\n"
           + "SELECT CAS2.IDENTIFIER "
           + "\nFROM CASE_T CAS2"
           + "\nLEFT JOIN CHLD_CLT CCL1 ON CCL1.FKCLIENT_T = CAS2.FKCHLD_CLT  "
           + "\nLEFT JOIN CLIENT_T CLC1 ON CLC1.IDENTIFIER = CCL1.FKCLIENT_T "
           + "\nWHERE CCL1.IBMSNAP_LOGMARKER > ? "
       + "\nUNION"
           + "\n SELECT CAS3.IDENTIFIER "
           + "\n FROM CASE_T CAS3 "
           + "\nLEFT JOIN CHLD_CLT CCL2 ON CCL2.FKCLIENT_T = CAS3.FKCHLD_CLT  "
           + "\nLEFT JOIN CLIENT_T CLC2 ON CLC2.IDENTIFIER = CCL2.FKCLIENT_T "
           + "\nWHERE CLC2.IBMSNAP_LOGMARKER > ? "
       + "\nUNION "
           + "\nSELECT CAS3.IDENTIFIER "
           + "\nFROM CASE_T CAS3 "
           + "\nLEFT JOIN CHLD_CLT CCL3 ON CCL3.FKCLIENT_T = CAS3.FKCHLD_CLT  "
           + "\nLEFT JOIN CLIENT_T CLC3 ON CLC3.IDENTIFIER = CCL3.FKCLIENT_T "
           + "\nJOIN CLN_RELT CLR ON CLR.FKCLIENT_T = CCL3.FKCLIENT_T AND ((CLR.CLNTRELC BETWEEN 187 and 214) OR "
           + "\n(CLR.CLNTRELC BETWEEN 245 and 254) OR (CLR.CLNTRELC BETWEEN 282 and 294) OR (CLR.CLNTRELC IN (272, 273, 5620, 6360, 6361))) "
           + "\nWHERE CLR.IBMSNAP_LOGMARKER > ? "
       + "\nUNION "
           + "\nSELECT CAS.IDENTIFIER "
           + "\nFROM CASE_T CAS "
           + "\nLEFT JOIN CHLD_CLT CCL ON CCL.FKCLIENT_T = CAS.FKCHLD_CLT "
           + "\nLEFT JOIN CLIENT_T CLC ON CLC.IDENTIFIER = CCL.FKCLIENT_T "
           + "\nJOIN CLN_RELT CLR ON CLR.FKCLIENT_T = CCL.FKCLIENT_T AND ((CLR.CLNTRELC BETWEEN 187 and 214) OR "
           + "\n(CLR.CLNTRELC BETWEEN 245 and 254) OR (CLR.CLNTRELC BETWEEN 282 and 294) OR (CLR.CLNTRELC IN (272, 273, 5620, 6360, 6361))) "
           + "\nJOIN CLIENT_T CLP ON CLP.IDENTIFIER = CLR.FKCLIENT_0 "
           + "\nWHERE CLP.IBMSNAP_LOGMARKER > ? "
      + "\n) x";
  //@formatter:on

  //@formatter:off
  public static final String SELECT_LAST_RUN_CHILD = 
        "SELECT \n"
      + " CAS.IDENTIFIER AS CASE_ID, \n"
      + " CAS.START_DT   AS START_DATE, \n"
      + " CAS.END_DT     AS END_DATE, \n"
      + " CAS.GVR_ENTC   AS COUNTY, \n"
      + " CAS.SRV_CMPC   AS SERVICE_COMP, \n"
      + " CAS.LMT_ACSSCD AS LIMITED_ACCESS_CODE, \n"
      + " CAS.LMT_ACS_DT AS LIMITED_ACCESS_DATE, \n"
      + " CAS.LMT_ACSDSC AS LIMITED_ACCESS_DESCRIPTION, \n"
      + " CAS.L_GVR_ENTC AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
      + " CAS.LST_UPD_TS AS CASE_LAST_UPDATED, \n"
      + " CLC.COM_FST_NM AS FOCUS_CHLD_FIRST_NM, \n"
      + " CLC.COM_LST_NM AS FOCUS_CHLD_LAST_NM, \n"
      + " CLC.IDENTIFIER AS FOCUS_CHILD_ID, \n"
      + " CLC.SENSTV_IND AS FOCUS_CHILD_SENSITIVITY_IND, \n"
      + " CLC.LST_UPD_TS AS FOCUS_CHILD_LAST_UPDATED, \n"
      + " CLP.COM_FST_NM AS PARENT_FIRST_NM, \n"
      + " CLP.COM_LST_NM AS PARENT_LAST_NM, \n"
      + " CLR.CLNTRELC   AS PARENT_RELATIONSHIP, \n"
      + " CLP.IDENTIFIER AS PARENT_ID, \n"
      + " CLP.SENSTV_IND AS PARENT_SENSITIVITY_IND, \n"
      + " CLP.LST_UPD_TS AS PARENT_LAST_UPDATED, \n"
      + " 'CLIENT_T'     AS PARENT_SOURCE_TABLE, \n"
      + " STF.FIRST_NM   AS WORKER_FIRST_NM, \n"
      + " STF.LAST_NM    AS WORKER_LAST_NM, \n"
      + " STF.IDENTIFIER AS WORKER_ID, \n"
      + " STF.LST_UPD_TS AS WORKER_LAST_UPDATED, \n"
      + " CAS.IBMSNAP_LOGMARKER AS CAS_IBMSNAP_LOGMARKER, \n"
      + " CAS.IBMSNAP_OPERATION AS CAS_IBMSNAP_OPERATION, \n"
      + " CLC.IBMSNAP_LOGMARKER AS CLC_IBMSNAP_LOGMARKER, \n"
      + " CLC.IBMSNAP_OPERATION AS CLC_IBMSNAP_OPERATION, \n"
      + " CLP.IBMSNAP_LOGMARKER AS CLP_IBMSNAP_LOGMARKER, \n"
      + " CLP.IBMSNAP_OPERATION AS CLP_IBMSNAP_OPERATION, \n"
      + " STF.IBMSNAP_LOGMARKER AS STF_IBMSNAP_LOGMARKER, \n"
      + " STF.IBMSNAP_OPERATION AS STF_IBMSNAP_OPERATION, \n"
      + " MAX( \n"
      + "     NVL(CAS.IBMSNAP_LOGMARKER, TIMESTAMP('2008-09-30 11:54:40')),\n"
      + "     NVL(CLC.IBMSNAP_LOGMARKER, TIMESTAMP('2008-09-30 11:54:40')),\n"
      + "     NVL(CLP.IBMSNAP_LOGMARKER, TIMESTAMP('2008-09-30 11:54:40')) \n"
      + " ) LAST_CHG \n"
      + "FROM CASE_T CAS \n"
      + "JOIN STFPERST STF ON STF.IDENTIFIER = CAS.FKSTFPERST \n"
      + "JOIN CHLD_CLT CCL ON CCL.FKCLIENT_T = CAS.FKCHLD_CLT \n"
      + "JOIN CLIENT_T CLC ON CLC.IDENTIFIER = CCL.FKCLIENT_T \n"
      + "LEFT JOIN CLN_RELT CLR ON CLR.FKCLIENT_0 = CCL.FKCLIENT_T "
   // + "AND ((CLR.CLNTRELC BETWEEN 187 and 214) OR \n"
   // + "(CLR.CLNTRELC BETWEEN 245 and 254) OR (CLR.CLNTRELC BETWEEN 282 and 294) OR (CLR.CLNTRELC IN (272, 273, 5620, 6360, 6361))) \n"
      + "LEFT JOIN CLIENT_T CLP ON CLP.IDENTIFIER = CLR.FKCLIENT_T \n"
      + "WHERE CAS.IDENTIFIER IN ( \n"
      + "   SELECT GT.IDENTIFIER FROM GT_ID GT \n"
      + ") \n";
  //@formatter:on

  //@formatter:off
  public static final String SELECT_LAST_RUN_PARENT = 
        "SELECT \n"
      + "  CAS.IDENTIFIER AS CASE_ID, \n"
      + "  CAS.START_DT   AS START_DATE, \n"
      + "  CAS.END_DT     AS END_DATE, \n"
      + "  CAS.GVR_ENTC   AS COUNTY, \n"
      + "  CAS.SRV_CMPC   AS SERVICE_COMP, \n"
      + "  CAS.LMT_ACSSCD AS LIMITED_ACCESS_CODE, \n"
      + "  CAS.LMT_ACS_DT AS LIMITED_ACCESS_DATE, \n"
      + "  CAS.LMT_ACSDSC AS LIMITED_ACCESS_DESCRIPTION, \n"
      + "  CAS.L_GVR_ENTC AS LIMITED_ACCESS_GOVERNMENT_ENT, \n"
      + "  CAS.LST_UPD_TS AS CASE_LAST_UPDATED, \n"
      + "  CLC.COM_FST_NM AS FOCUS_CHLD_FIRST_NM, \n"
      + "  CLC.COM_LST_NM AS FOCUS_CHLD_LAST_NM, \n"
      + "  CLC.IDENTIFIER AS FOCUS_CHILD_ID, \n"
      + "  CLC.SENSTV_IND AS FOCUS_CHILD_SENSITIVITY_IND, \n"
      + "  CLC.LST_UPD_TS AS FOCUS_CHILD_LAST_UPDATED, \n"
      + "  CLP.COM_FST_NM AS PARENT_FIRST_NM, \n"
      + "  CLP.COM_LST_NM AS PARENT_LAST_NM, \n"
      + "  CLR.CLNTRELC   AS PARENT_RELATIONSHIP, \n"
      + "  CLP.IDENTIFIER AS PARENT_ID, \n"
      + "  CLP.SENSTV_IND AS PARENT_SENSITIVITY_IND, \n"
      + "  CLP.LST_UPD_TS AS PARENT_LAST_UPDATED, \n"
      + "  'CLIENT_T'     AS PARENT_SOURCE_TABLE, \n"
      + "  STF.FIRST_NM   AS WORKER_FIRST_NM, \n"
      + "  STF.LAST_NM    AS WORKER_LAST_NM, \n"
      + "  STF.IDENTIFIER AS WORKER_ID, \n"
      + "  STF.LST_UPD_TS AS WORKER_LAST_UPDATED,   \n"
      + "  CAS.IBMSNAP_LOGMARKER AS CAS_IBMSNAP_LOGMARKER, \n"
      + "  CAS.IBMSNAP_OPERATION AS CAS_IBMSNAP_OPERATION, \n"
      + "  CLC.IBMSNAP_LOGMARKER AS CLC_IBMSNAP_LOGMARKER, \n"
      + "  CLC.IBMSNAP_OPERATION AS CLC_IBMSNAP_OPERATION, \n"
      + "  CLP.IBMSNAP_LOGMARKER AS CLP_IBMSNAP_LOGMARKER, \n"
      + "  CLP.IBMSNAP_OPERATION AS CLP_IBMSNAP_OPERATION, \n"
      + "  STF.IBMSNAP_LOGMARKER AS STF_IBMSNAP_LOGMARKER, \n"
      + "  STF.IBMSNAP_OPERATION AS STF_IBMSNAP_OPERATION, \n"
      + "  MAX ( \n"
      + "    NVL(CAS.IBMSNAP_LOGMARKER, TIMESTAMP('2008-09-30 11:54:40')),\n"
      + "    NVL(CLC.IBMSNAP_LOGMARKER, TIMESTAMP('2008-09-30 11:54:40')),\n"
      + "    NVL(CLP.IBMSNAP_LOGMARKER, TIMESTAMP('2008-09-30 11:54:40')) \n"
      + "  ) LAST_CHG \n"
      + "FROM CASE_T CAS \n"
      + "JOIN STFPERST STF ON STF.IDENTIFIER = CAS.FKSTFPERST \n"
      + "JOIN CHLD_CLT CCL ON CCL.FKCLIENT_T = CAS.FKCHLD_CLT \n"
      + "JOIN CLIENT_T CLC ON CLC.IDENTIFIER = CCL.FKCLIENT_T \n"
      + "LEFT JOIN CLN_RELT CLR ON CLR.FKCLIENT_T = CCL.FKCLIENT_T "
   // + "AND ((CLR.CLNTRELC BETWEEN 187 and 214) OR \n"
   // + "(CLR.CLNTRELC BETWEEN 245 and 254) OR (CLR.CLNTRELC BETWEEN 282 and 294) OR (CLR.CLNTRELC IN (272, 273, 5620, 6360, 6361))) \n"
      + "LEFT JOIN CLIENT_T CLP ON CLP.IDENTIFIER = CLR.FKCLIENT_0 \n"
      + "WHERE CAS.IDENTIFIER IN ( \n"
      + "   SELECT GT.IDENTIFIER FROM GT_ID GT \n"
      + ") \n";
  //@formatter:on

}
